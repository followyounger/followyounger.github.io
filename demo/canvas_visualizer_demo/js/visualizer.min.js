(function(b){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=b()}else{if(typeof define==="function"&&define.amd){define([],b)}else{var a;if(typeof window!=="undefined"){a=window}else{if(typeof global!=="undefined"){a=global}else{if(typeof self!=="undefined"){a=self}else{a=this}}}a.jsmediatags=b()}}})(function(){var d,b,a;return(function c(f,k,h){function g(s,p){if(!k[s]){if(!f[s]){var n=typeof require=="function"&&require;if(!p&&n){return n(s,!0)}if(e){return e(s,!0)}var q=new Error("Cannot find module '"+s+"'");throw q.code="MODULE_NOT_FOUND",q}var m=k[s]={exports:{}};f[s][0].call(m.exports,function(l){var o=f[s][1][l];return g(o?o:l)},m,m.exports,c,f,k,h)}return k[s].exports}var e=typeof require=="function"&&require;for(var j=0;j<h.length;j++){g(h[j])}return g})({1:[function(f,g,e){},{}],2:[function(f,g,e){g.exports=XMLHttpRequest},{}],3:[function(j,g,m){function h(w){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){v=function v(x){return typeof x}}else{v=function v(x){return x&&typeof Symbol==="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x}}return v(w)}function p(v,w){if(!(v instanceof w)){throw new TypeError("Cannot call a class as a function")}}function u(y,w){for(var v=0;v<w.length;v++){var x=w[v];x.enumerable=x.enumerable||false;x.configurable=true;if("value" in x){x.writable=true}Object.defineProperty(y,x.key,x)}}function k(x,v,w){if(v){u(x.prototype,v)}if(w){u(x,w)}return x}function q(v,w){if(w&&(h(w)==="object"||typeof w==="function")){return w}return f(v)}function s(w){v=Object.setPrototypeOf?Object.getPrototypeOf:function v(x){return x.__proto__||Object.getPrototypeOf(x)};return v(w)}function f(v){if(v===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return v}function t(w,v){if(typeof v!=="function"&&v!==null){throw new TypeError("Super expression must either be null or a function")}w.prototype=Object.create(v&&v.prototype,{constructor:{value:w,writable:true,configurable:true}});if(v){o(w,v)}}function o(w,v){x=Object.setPrototypeOf||function x(z,y){z.__proto__=y;return z};return x(w,v)}function e(x,v,w){if(v in x){Object.defineProperty(x,v,{value:w,enumerable:true,configurable:true,writable:true})}else{x[v]=w}return x}var n=j("./MediaFileReader");var l=function(x){t(w,x);function w(C){var B;p(this,w);B=q(this,s(w).call(this));e(f(B),"_array",void 0);e(f(B),"_size",void 0);B._array=C;B._size=C.length;B._isInitialized=true;return B}k(w,[{key:"init",value:function z(B){setTimeout(B.onSuccess,0)}},{key:"loadRange",value:function v(B,C){setTimeout(C.onSuccess,0)}},{key:"getByteAt",value:function A(B){if(B>=this._array.length){throw new Error("Offset "+B+" hasn't been loaded yet.")}return this._array[B]}}],[{key:"canReadFile",value:function y(B){return Array.isArray(B)||typeof Buffer==="function"&&Buffer.isBuffer(B)}}]);return w}(n);g.exports=l},{"./MediaFileReader":11}],4:[function(k,g,n){function h(x){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){w=function w(y){return typeof y}}else{w=function w(y){return y&&typeof Symbol==="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y}}return w(x)}function q(w,x){if(!(w instanceof x)){throw new TypeError("Cannot call a class as a function")}}function v(z,x){for(var w=0;w<x.length;w++){var y=x[w];y.enumerable=y.enumerable||false;y.configurable=true;if("value" in y){y.writable=true}Object.defineProperty(z,y.key,y)}}function l(y,w,x){if(w){v(y.prototype,w)}if(x){v(y,x)}return y}function s(w,x){if(x&&(h(x)==="object"||typeof x==="function")){return x}return f(w)}function t(x){w=Object.setPrototypeOf?Object.getPrototypeOf:function w(y){return y.__proto__||Object.getPrototypeOf(y)};return w(x)}function f(w){if(w===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return w}function u(x,w){if(typeof w!=="function"&&w!==null){throw new TypeError("Super expression must either be null or a function")}x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,writable:true,configurable:true}});if(w){p(x,w)}}function p(x,w){y=Object.setPrototypeOf||function y(A,z){A.__proto__=z;return A};return y(x,w)}function e(y,w,x){if(w in y){Object.defineProperty(y,w,{value:x,enumerable:true,configurable:true,writable:true})}else{y[w]=x}return y}var j=k("./ChunkedFileData");var o=k("./MediaFileReader");var m=function(y){u(x,y);function x(C){var D;q(this,x);D=s(this,t(x).call(this));e(f(D),"_blob",void 0);e(f(D),"_fileData",void 0);D._blob=C;D._fileData=new j();return D}l(x,[{key:"_init",value:function A(C){this._size=this._blob.size;setTimeout(C.onSuccess,1)}},{key:"loadRange",value:function w(E,H){var D=this;var G=this._blob.slice||this._blob.mozSlice||this._blob.webkitSlice;var C=G.call(this._blob,E[0],E[1]+1);var F=new FileReader();F.onloadend=function(I){var J=new Uint8Array(F.result);D._fileData.addData(E[0],J);H.onSuccess()};F.onerror=F.onabort=function(I){if(H.onError){H.onError({type:"blob",info:F.error})}};F.readAsArrayBuffer(C)}},{key:"getByteAt",value:function B(C){return this._fileData.getByteAt(C)}}],[{key:"canReadFile",value:function z(C){return typeof Blob!=="undefined"&&C instanceof Blob||typeof File!=="undefined"&&C instanceof File}}]);return x}(o);g.exports=m},{"./ChunkedFileData":5,"./MediaFileReader":11}],5:[function(h,e,k){function l(o,p){if(!(o instanceof p)){throw new TypeError("Cannot call a class as a function")}}function m(s,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(s,q.key,q)}}function j(q,o,p){if(o){m(q.prototype,o)}if(p){m(q,p)}return q}function f(q,o,p){if(o in q){Object.defineProperty(q,o,{value:p,enumerable:true,configurable:true,writable:true})}else{q[o]=p}return q}var n=-1;var g=function(){j(q,null,[{key:"NOT_FOUND",get:function p(){return n}}]);function q(){l(this,q);f(this,"_fileData",void 0);this._fileData=[]}j(q,[{key:"addData",value:function w(z,A){var F=z+A.length-1;var B=this._getChunkRange(z,F);if(B.startIx===n){this._fileData.splice(B.insertIx||0,0,{offset:z,data:A})}else{var y=this._fileData[B.startIx];var C=this._fileData[B.endIx];var D=z>y.offset;var x=F<C.offset+C.data.length-1;var E={offset:Math.min(z,y.offset),data:A};if(D){var G=this._sliceData(y.data,0,z-y.offset);E.data=this._concatData(G,A)}if(x){var G=this._sliceData(E.data,0,C.offset-E.offset);E.data=this._concatData(G,C.data)}this._fileData.splice(B.startIx,B.endIx-B.startIx+1,E)}}},{key:"_concatData",value:function u(y,x){if(typeof ArrayBuffer!=="undefined"&&ArrayBuffer.isView&&ArrayBuffer.isView(y)){var z=new y.constructor(y.length+x.length);z.set(y,0);z.set(x,y.length);return z}else{return y.concat(x)}}},{key:"_sliceData",value:function t(z,y,x){if(z.slice){return z.slice(y,x)}else{return z.subarray(y,x)}}},{key:"_getChunkRange",value:function s(E,D){var B=n;var A=n;var C=0;for(var z=0;z<this._fileData.length;z++,C=z){var y=this._fileData[z].offset;var x=y+this._fileData[z].data.length;if(D<y-1){break}if(E<=x+1&&D>=y-1){B=z;break}}if(B===n){return{startIx:n,endIx:n,insertIx:C}}for(var z=B;z<this._fileData.length;z++){var y=this._fileData[z].offset;var x=y+this._fileData[z].data.length;if(D>=y-1){A=z}if(D<=x+1){break}}if(A===n){A=B}return{startIx:B,endIx:A}}},{key:"hasDataRange",value:function o(A,z){for(var y=0;y<this._fileData.length;y++){var x=this._fileData[y];if(z<x.offset){return false}if(A>=x.offset&&z<x.offset+x.data.length){return true}}return false}},{key:"getByteAt",value:function v(A){var y;for(var x=0;x<this._fileData.length;x++){var z=this._fileData[x].offset;var B=z+this._fileData[x].data.length-1;if(A>=z&&A<=B){y=this._fileData[x];break}}if(y){return y.data[A-y.offset]}throw new Error("Offset "+A+" hasn't been loaded yet.")}}]);return q}();e.exports=g},{}],6:[function(l,f,y){function n(A){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){z=function z(B){return typeof B}}else{z=function z(B){return B&&typeof Symbol==="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B}}return z(A)}function h(z,A){if(!(z instanceof A)){throw new TypeError("Cannot call a class as a function")}}function k(C,A){for(var z=0;z<A.length;z++){var B=A[z];B.enumerable=B.enumerable||false;B.configurable=true;if("value" in B){B.writable=true}Object.defineProperty(C,B.key,B)}}function w(B,z,A){if(z){k(B.prototype,z)}if(A){k(B,A)}return B}function m(z,A){if(A&&(n(A)==="object"||typeof A==="function")){return A}return u(z)}function o(A){z=Object.setPrototypeOf?Object.getPrototypeOf:function z(B){return B.__proto__||Object.getPrototypeOf(B)};return z(A)}function u(z){if(z===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return z}function s(A,z){if(typeof z!=="function"&&z!==null){throw new TypeError("Super expression must either be null or a function")}A.prototype=Object.create(z&&z.prototype,{constructor:{value:A,writable:true,configurable:true}});if(z){g(A,z)}}function g(A,z){B=Object.setPrototypeOf||function B(D,C){D.__proto__=C;return D};return B(A,z)}function x(B,z,A){if(z in B){Object.defineProperty(B,z,{value:A,enumerable:true,configurable:true,writable:true})}else{B[z]=A}return B}var j=l("./MediaTagReader");var t=4;var p=[4,132];var q=[6,134];var v=["Other","32x32 pixels 'file icon' (PNG only)","Other file icon","Cover (front)","Cover (back)","Leaflet page","Media (e.g. label side of CD)","Lead artist/lead performer/soloist","Artist/performer","Conductor","Band/Orchestra","Composer","Lyricist/text writer","Recording Location","During recording","During performance","Movie/video screen capture","A bright coloured fish","Illustration","Band/artist logotype","Publisher/Studio logotype"];var e=function(E){s(F,E);function F(){var K;var L;h(this,F);for(var H=arguments.length,I=new Array(H),J=0;J<H;J++){I[J]=arguments[J]}L=m(this,(K=o(F)).call.apply(K,[this].concat(I)));x(u(L),"_commentOffset",void 0);x(u(L),"_pictureOffset",void 0);return L}w(F,[{key:"_loadData",value:function z(J,I){var H=this;J.loadRange([4,7],{onSuccess:function K(){H._loadBlock(J,4,I)}})}},{key:"_loadBlock",value:function G(L,O,K){var H=this;var M=L.getByteAt(O);var J=L.getInteger24At(O+1,true);if(p.indexOf(M)!==-1){var I=O+4;L.loadRange([I,I+J],{onSuccess:function N(){H._commentOffset=I;H._nextBlock(L,O,M,J,K)}})}else{if(q.indexOf(M)!==-1){var I=O+4;L.loadRange([I,I+J],{onSuccess:function N(){H._pictureOffset=I;H._nextBlock(L,O,M,J,K)}})}else{H._nextBlock(L,O,M,J,K)}}}},{key:"_nextBlock",value:function D(K,N,L,I,J){var H=this;if(L>127){if(!H._commentOffset){J.onError({type:"loadData",info:"Comment block could not be found."})}else{J.onSuccess()}}else{K.loadRange([N+4+I,N+4+4+I],{onSuccess:function M(){H._loadBlock(K,N+4+I,J)}})}}},{key:"_parseData",value:function A(aj,V){var ai=aj.getLongAt(this._commentOffset,false);var T=this._commentOffset+4;var am=ai+T;var N=aj.getLongAt(am,false);var S=am+4;var al,M,ab,Y,K,Q;for(var ae=0;ae<N;ae++){var ac=aj.getLongAt(S,false);var W=aj.getStringWithCharsetAt(S+4,ac,"utf-8").toString();var ag=W.indexOf("=");var aa=[W.slice(0,ag),W.slice(ag+1)];switch(aa[0]){case"TITLE":al=aa[1];break;case"ARTIST":M=aa[1];break;case"ALBUM":ab=aa[1];break;case"TRACKNUMBER":Y=aa[1];break;case"GENRE":K=aa[1];break}S+=4+ac}if(this._pictureOffset){var H=aj.getLongAt(this._pictureOffset,true);var X=this._pictureOffset+4;var Z=aj.getLongAt(X,true);var R=X+4;var O=aj.getStringAt(R,Z);var J=R+Z;var U=aj.getLongAt(J,true);var I=J+4;var ad=aj.getStringWithCharsetAt(I,U,"utf-8").toString();var ah=I+U+16;var P=aj.getLongAt(ah,true);var L=ah+4;var af=aj.getBytesAt(L,P,true);Q={format:O,type:v[H],description:ad,data:af}}var ak={type:"FLAC",version:"1",tags:{title:al,artist:M,album:ab,track:Y,genre:K,picture:Q}};return ak}}],[{key:"getTagIdentifierByteRange",value:function C(){return{offset:0,length:t}}},{key:"canReadTagFormat",value:function B(H){var I=String.fromCharCode.apply(String,H.slice(0,4));return I==="fLaC"}}]);return F}(j);f.exports=e},{"./MediaTagReader":12}],7:[function(h,f,k){function g(x){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){w=function w(y){return typeof y}}else{w=function w(y){return y&&typeof Symbol==="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y}}return w(x)}function n(w,x){if(!(w instanceof x)){throw new TypeError("Cannot call a class as a function")}}function v(z,x){for(var w=0;w<x.length;w++){var y=x[w];y.enumerable=y.enumerable||false;y.configurable=true;if("value" in y){y.writable=true}Object.defineProperty(z,y.key,y)}}function j(y,w,x){if(w){v(y.prototype,w)}if(x){v(y,x)}return y}function s(w,x){if(x&&(g(x)==="object"||typeof x==="function")){return x}return e(w)}function e(w){if(w===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return w}function t(x){w=Object.setPrototypeOf?Object.getPrototypeOf:function w(y){return y.__proto__||Object.getPrototypeOf(y)};return w(x)}function u(x,w){if(typeof w!=="function"&&w!==null){throw new TypeError("Super expression must either be null or a function")}x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,writable:true,configurable:true}});if(w){m(x,w)}}function m(x,w){y=Object.setPrototypeOf||function y(A,z){A.__proto__=z;return A};return y(x,w)}var q=h("./MediaTagReader");var l=h("./MediaFileReader");var p=function(A){u(B,A);function B(){n(this,B);return s(this,t(B).apply(this,arguments))}j(B,[{key:"_loadData",value:function w(E,D){var C=E.getSize();E.loadRange([C-128,C-1],D)}},{key:"_parseData",value:function x(G,P){var E=G.getSize()-128;var N=G.getStringWithCharsetAt(E+3,30).toString();var F=G.getStringWithCharsetAt(E+33,30).toString();var D=G.getStringWithCharsetAt(E+63,30).toString();var M=G.getStringWithCharsetAt(E+93,4).toString();var H=G.getByteAt(E+97+28);var C=G.getByteAt(E+97+29);if(H==0&&C!=0){var L="1.1";var I=G.getStringWithCharsetAt(E+97,28).toString()}else{var L="1.0";var I=G.getStringWithCharsetAt(E+97,30).toString();C=0}var K=G.getByteAt(E+97+30);if(K<255){var J=o[K]}else{var J=""}var O={type:"ID3",version:L,tags:{title:N,artist:F,album:D,year:M,comment:I,genre:J}};if(C){O.tags.track=C}return O}}],[{key:"getTagIdentifierByteRange",value:function z(){return{offset:-128,length:128}}},{key:"canReadTagFormat",value:function y(C){var D=String.fromCharCode.apply(String,C.slice(0,3));return D==="TAG"}}]);return B}(q);var o=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychadelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk-Rock","National Folk","Swing","Fast Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","Acapella","Euro-House","Dance Hall"];f.exports=p},{"./MediaFileReader":11,"./MediaTagReader":12}],8:[function(q,e,C){function h(E,F){if(!(E instanceof F)){throw new TypeError("Cannot call a class as a function")}}function m(H,F){for(var E=0;E<F.length;E++){var G=F[E];G.enumerable=G.enumerable||false;G.configurable=true;if("value" in G){G.writable=true}Object.defineProperty(H,G.key,G)}}function A(G,E,F){if(E){m(G.prototype,E)}if(F){m(G,F)}return G}var j=q("./MediaFileReader");var D=q("./StringUtils");var x=q("./ArrayFileReader");var n={BUF:"Recommended buffer size",CNT:"Play counter",COM:"Comments",CRA:"Audio encryption",CRM:"Encrypted meta frame",ETC:"Event timing codes",EQU:"Equalization",GEO:"General encapsulated object",IPL:"Involved people list",LNK:"Linked information",MCI:"Music CD Identifier",MLL:"MPEG location lookup table",PIC:"Attached picture",POP:"Popularimeter",REV:"Reverb",RVA:"Relative volume adjustment",SLT:"Synchronized lyric/text",STC:"Synced tempo codes",TAL:"Album/Movie/Show title",TBP:"BPM (Beats Per Minute)",TCM:"Composer",TCO:"Content type",TCR:"Copyright message",TDA:"Date",TDY:"Playlist delay",TEN:"Encoded by",TFT:"File type",TIM:"Time",TKE:"Initial key",TLA:"Language(s)",TLE:"Length",TMT:"Media type",TOA:"Original artist(s)/performer(s)",TOF:"Original filename",TOL:"Original Lyricist(s)/text writer(s)",TOR:"Original release year",TOT:"Original album/Movie/Show title",TP1:"Lead artist(s)/Lead performer(s)/Soloist(s)/Performing group",TP2:"Band/Orchestra/Accompaniment",TP3:"Conductor/Performer refinement",TP4:"Interpreted, remixed, or otherwise modified by",TPA:"Part of a set",TPB:"Publisher",TRC:"ISRC (International Standard Recording Code)",TRD:"Recording dates",TRK:"Track number/Position in set",TSI:"Size",TSS:"Software/hardware and settings used for encoding",TT1:"Content group description",TT2:"Title/Songname/Content description",TT3:"Subtitle/Description refinement",TXT:"Lyricist/text writer",TXX:"User defined text information frame",TYE:"Year",UFI:"Unique file identifier",ULT:"Unsychronized lyric/text transcription",WAF:"Official audio file webpage",WAR:"Official artist/performer webpage",WAS:"Official audio source webpage",WCM:"Commercial information",WCP:"Copyright/Legal information",WPB:"Publishers official webpage",WXX:"User defined URL link frame",AENC:"Audio encryption",APIC:"Attached picture",ASPI:"Audio seek point index",CHAP:"Chapter",CTOC:"Table of contents",COMM:"Comments",COMR:"Commercial frame",ENCR:"Encryption method registration",EQU2:"Equalisation (2)",EQUA:"Equalization",ETCO:"Event timing codes",GEOB:"General encapsulated object",GRID:"Group identification registration",IPLS:"Involved people list",LINK:"Linked information",MCDI:"Music CD identifier",MLLT:"MPEG location lookup table",OWNE:"Ownership frame",PRIV:"Private frame",PCNT:"Play counter",POPM:"Popularimeter",POSS:"Position synchronisation frame",RBUF:"Recommended buffer size",RVA2:"Relative volume adjustment (2)",RVAD:"Relative volume adjustment",RVRB:"Reverb",SEEK:"Seek frame",SYLT:"Synchronized lyric/text",SYTC:"Synchronized tempo codes",TALB:"Album/Movie/Show title",TBPM:"BPM (beats per minute)",TCOM:"Composer",TCON:"Content type",TCOP:"Copyright message",TDAT:"Date",TDLY:"Playlist delay",TDRC:"Recording time",TDRL:"Release time",TDTG:"Tagging time",TENC:"Encoded by",TEXT:"Lyricist/Text writer",TFLT:"File type",TIME:"Time",TIPL:"Involved people list",TIT1:"Content group description",TIT2:"Title/songname/content description",TIT3:"Subtitle/Description refinement",TKEY:"Initial key",TLAN:"Language(s)",TLEN:"Length",TMCL:"Musician credits list",TMED:"Media type",TMOO:"Mood",TOAL:"Original album/movie/show title",TOFN:"Original filename",TOLY:"Original lyricist(s)/text writer(s)",TOPE:"Original artist(s)/performer(s)",TORY:"Original release year",TOWN:"File owner/licensee",TPE1:"Lead performer(s)/Soloist(s)",TPE2:"Band/orchestra/accompaniment",TPE3:"Conductor/performer refinement",TPE4:"Interpreted, remixed, or otherwise modified by",TPOS:"Part of a set",TPRO:"Produced notice",TPUB:"Publisher",TRCK:"Track number/Position in set",TRDA:"Recording dates",TRSN:"Internet radio station name",TRSO:"Internet radio station owner",TSOA:"Album sort order",TSOP:"Performer sort order",TSOT:"Title sort order",TSIZ:"Size",TSRC:"ISRC (international standard recording code)",TSSE:"Software/Hardware and settings used for encoding",TSST:"Set subtitle",TYER:"Year",TXXX:"User defined text information frame",UFID:"Unique file identifier",USER:"Terms of use",USLT:"Unsychronized lyric/text transcription",WCOM:"Commercial information",WCOP:"Copyright/Legal information",WOAF:"Official audio file webpage",WOAR:"Official artist/performer webpage",WOAS:"Official audio source webpage",WORS:"Official internet radio station homepage",WPAY:"Payment",WPUB:"Publishers official webpage",WXXX:"User defined URL link frame"};var v=function(){function H(){h(this,H)}A(H,null,[{key:"getFrameReaderFunction",value:function J(M){if(M in k){return k[M]}else{if(M[0]==="T"){return k["T*"]}else{if(M[0]==="W"){return k["W*"]}else{return null}}}}},{key:"readFrames",value:function G(Q,P,ad,T,W){var U={};var M=this._getFrameHeaderSize(T);while(Q<P-M){var ab=this._readFrameHeader(ad,Q,T);var O=ab.id;if(!O){break}var R=ab.flags;var Y=ab.size;var S=Q+ab.headerSize;var N=ad;Q+=ab.headerSize+ab.size;if(W&&W.indexOf(O)===-1){continue}if(O==="MP3e"||O==="\x00MP3"||O==="\x00\x00MP"||O===" MP3"){break}var X;if(R&&R.format.unsynchronisation){N=this.getUnsyncFileReader(N,S,Y);S=0;Y=N.getSize()}if(R&&R.format.data_length_indicator){S+=4;Y-=4}var aa=H.getFrameReaderFunction(O);var Z=aa?aa.apply(this,[S,Y,N,R,T]):null;var ac=this._getFrameDescription(O);var V={id:O,size:Y,description:ac,data:Z};if(O in U){if(U[O].id){U[O]=[U[O]]}U[O].push(V)}else{U[O]=V}}return U}},{key:"_getFrameHeaderSize",value:function L(M){var N=M.major;if(N==2){return 6}else{if(N==3||N==4){return 10}else{return 0}}}},{key:"_readFrameHeader",value:function K(S,T,N){var Q=N.major;var M=null;var P=this._getFrameHeaderSize(N);switch(Q){case 2:var R=S.getStringAt(T,3);var O=S.getInteger24At(T+3,true);break;case 3:var R=S.getStringAt(T,4);var O=S.getLongAt(T+4,true);break;case 4:var R=S.getStringAt(T,4);var O=S.getSynchsafeInteger32At(T+4);break}if(R==String.fromCharCode(0,0,0)||R==String.fromCharCode(0,0,0,0)){R=""}if(R){if(Q>2){M=this._readFrameFlags(S,T+8)}}return{id:R||"",size:O||0,headerSize:P||0,flags:M}}},{key:"_readFrameFlags",value:function I(M,N){return{message:{tag_alter_preservation:M.isBitSetAt(N,6),file_alter_preservation:M.isBitSetAt(N,5),read_only:M.isBitSetAt(N,4)},format:{grouping_identity:M.isBitSetAt(N+1,7),compression:M.isBitSetAt(N+1,3),encryption:M.isBitSetAt(N+1,2),unsynchronisation:M.isBitSetAt(N+1,1),data_length_indicator:M.isBitSetAt(N+1,0)}}}},{key:"_getFrameDescription",value:function F(M){if(M in n){return n[M]}else{return"Unknown"}}},{key:"getUnsyncFileReader",value:function E(P,Q,N){var O=P.getBytesAt(Q,N);for(var M=0;M<O.length-1;M++){if(O[M]===255&&O[M+1]===0){O.splice(M+1,1)}}return new x(O)}}]);return H}();var k={};k.APIC=function l(I,F,J,G,M){var E=I;var H=o(J.getByteAt(I));switch(M&&M.major){case 2:var O=J.getStringAt(I+1,3);I+=4;break;case 3:case 4:var O=J.getStringWithCharsetAt(I+1,F-1);I+=1+O.bytesReadCount;break;default:throw new Error("Couldn't read ID3v2 major version.")}var K=J.getByteAt(I);var N=w[K];var L=J.getStringWithCharsetAt(I+1,F-(I-E)-1,H);I+=1+L.bytesReadCount;return{format:O.toString(),type:N,description:L.toString(),data:J.getBytesAt(I,E+F-I)}};k.CHAP=function z(I,G,J,H,K){var L=I;var M={};var E=D.readNullTerminatedString(J.getBytesAt(I,G));M.id=E.toString();I+=E.bytesReadCount;M.startTime=J.getLongAt(I,true);I+=4;M.endTime=J.getLongAt(I,true);I+=4;M.startOffset=J.getLongAt(I,true);I+=4;M.endOffset=J.getLongAt(I,true);I+=4;var F=G-(I-L);M.subFrames=this.readFrames(I,I+F,J,K);return M};k.CTOC=function f(J,G,L,H,M){var N=J;var O={childElementIds:[],id:undefined,topLevel:undefined,ordered:undefined,entryCount:undefined,subFrames:undefined};var E=D.readNullTerminatedString(L.getBytesAt(J,G));O.id=E.toString();J+=E.bytesReadCount;O.topLevel=L.isBitSetAt(J,1);O.ordered=L.isBitSetAt(J,0);J++;O.entryCount=L.getByteAt(J);J++;for(var K=0;K<O.entryCount;K++){var I=D.readNullTerminatedString(L.getBytesAt(J,G-(J-N)));O.childElementIds.push(I.toString());J+=I.bytesReadCount}var F=G-(J-N);O.subFrames=this.readFrames(J,J+F,L,M);return O};k.COMM=function u(I,F,K,G,L){var E=I;var H=o(K.getByteAt(I));var J=K.getStringAt(I+1,3);var M=K.getStringWithCharsetAt(I+4,F-4,H);I+=4+M.bytesReadCount;var N=K.getStringWithCharsetAt(I,E+F-I,H);return{language:J,short_description:M.toString(),text:N.toString()}};k.COM=k.COMM;k.PIC=function(I,G,H,F,E){return k.APIC(I,G,H,F,E)};k.PCNT=function y(I,G,H,F,E){return H.getLongAt(I,false)};k.CNT=k.PCNT;k["T*"]=function p(I,G,H,F,E){var J=o(H.getByteAt(I));return H.getStringWithCharsetAt(I+1,G-1,J).toString()};k.TXXX=function p(I,G,H,F,E){var J=o(H.getByteAt(I));return g(I,G,H,J)};k.WXXX=function B(I,G,H,F,E){if(G===0){return null}var J=o(H.getByteAt(I));return g(I,G,H,J)};k["W*"]=function B(I,G,H,F,E){if(G===0){return null}return H.getStringWithCharsetAt(I,G,"iso-8859-1").toString()};k.TCON=function t(I,F,G,E){var H=k["T*"].apply(this,arguments);return H.replace(/^\(\d+\)/,"")};k.TCO=k.TCON;k.USLT=function s(K,G,M,H,N){var F=K;var J=o(M.getByteAt(K));var L=M.getStringAt(K+1,3);var E=M.getStringWithCharsetAt(K+4,G-4,J);K+=4+E.bytesReadCount;var I=M.getStringWithCharsetAt(K,F+G-K,J);return{language:L,descriptor:E.toString(),lyrics:I.toString()}};k.ULT=k.USLT;k.UFID=function s(K,I,J,G,F){var E=D.readNullTerminatedString(J.getBytesAt(K,I));K+=E.bytesReadCount;var H=J.getBytesAt(K,I-E.bytesReadCount);return{ownerIdentifier:E.toString(),identifier:H}};function o(F){var E;switch(F){case 0:E="iso-8859-1";break;case 1:E="utf-16";break;case 2:E="utf-16be";break;case 3:E="utf-8";break;default:E="iso-8859-1"}return E}function g(I,F,H,J){var E=H.getStringWithCharsetAt(I+1,F-1,J);var G=H.getStringWithCharsetAt(I+1+E.bytesReadCount,F-1-E.bytesReadCount,J);return{user_description:E.toString(),data:G.toString()}}var w=["Other","32x32 pixels 'file icon' (PNG only)","Other file icon","Cover (front)","Cover (back)","Leaflet page","Media (e.g. label side of CD)","Lead artist/lead performer/soloist","Artist/performer","Conductor","Band/Orchestra","Composer","Lyricist/text writer","Recording Location","During recording","During performance","Movie/video screen capture","A bright coloured fish","Illustration","Band/artist logotype","Publisher/Studio logotype"];e.exports=v},{"./ArrayFileReader":3,"./MediaFileReader":11,"./StringUtils":13}],9:[function(m,e,x){function o(z){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){y=function y(A){return typeof A}}else{y=function y(A){return A&&typeof Symbol==="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A}}return y(z)}function g(y,z){if(!(y instanceof z)){throw new TypeError("Cannot call a class as a function")}}function k(B,z){for(var y=0;y<z.length;y++){var A=z[y];A.enumerable=A.enumerable||false;A.configurable=true;if("value" in A){A.writable=true}Object.defineProperty(B,A.key,A)}}function u(A,y,z){if(y){k(A.prototype,y)}if(z){k(A,z)}return A}function n(y,z){if(z&&(o(z)==="object"||typeof z==="function")){return z}return t(y)}function t(y){if(y===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return y}function q(z){y=Object.setPrototypeOf?Object.getPrototypeOf:function y(A){return A.__proto__||Object.getPrototypeOf(A)};return y(z)}function s(z,y){if(typeof y!=="function"&&y!==null){throw new TypeError("Super expression must either be null or a function")}z.prototype=Object.create(y&&y.prototype,{constructor:{value:z,writable:true,configurable:true}});if(y){f(z,y)}}function f(z,y){A=Object.setPrototypeOf||function A(C,B){C.__proto__=B;return C};return A(z,y)}var j=m("./MediaTagReader");var h=m("./MediaFileReader");var p=m("./ID3v2FrameReader");var w=10;var v=function(D){s(F,D);function F(){g(this,F);return n(this,q(F).apply(this,arguments))}u(F,[{key:"_loadData",value:function y(H,G){H.loadRange([6,9],{onSuccess:function I(){H.loadRange([0,w+H.getSynchsafeInteger32At(6)-1],G)},onError:G.onError})}},{key:"_parseData",value:function A(L,W){var K=0;var P=L.getByteAt(K+3);if(P>4){return{type:"ID3",version:">2.4",tags:{}}}var Q=L.getByteAt(K+4);var M=L.isBitSetAt(K+5,7);var O=L.isBitSetAt(K+5,6);var I=L.isBitSetAt(K+5,5);var V=L.getSynchsafeInteger32At(K+6);K+=10;if(O){if(P===4){var U=L.getSynchsafeInteger32At(K);K+=U}else{var U=L.getLongAt(K,true);K+=U+4}}var T={type:"ID3",version:"2."+P+"."+Q,major:P,revision:Q,flags:{unsynchronisation:M,extended_header:O,experimental_indicator:I,footer_present:false},size:V,tags:{}};if(W){var G=this._expandShortcutTags(W)}var S=V+10;if(T.flags.unsynchronisation){L=p.getUnsyncFileReader(L,K,V);K=0;S=L.getSize()}var N=p.readFrames(K,S,L,T,G);for(var H in l){if(l.hasOwnProperty(H)){var R=this._getFrameData(N,l[H]);if(R){T.tags[H]=R}}}for(var J in N){if(N.hasOwnProperty(J)){T.tags[J]=N[J]}}return T}},{key:"_getFrameData",value:function z(J,H){var I;for(var G=0,K;K=H[G];G++){if(K in J){if(J[K] instanceof Array){I=J[K][0]}else{I=J[K]}return I.data}}}},{key:"getShortcuts",value:function E(){return l}}],[{key:"getTagIdentifierByteRange",value:function C(){return{offset:0,length:w}}},{key:"canReadTagFormat",value:function B(G){var H=String.fromCharCode.apply(String,G.slice(0,3));return H==="ID3"}}]);return F}(j);var l={title:["TIT2","TT2"],artist:["TPE1","TP1"],album:["TALB","TAL"],year:["TYER","TYE"],comment:["COMM","COM"],track:["TRCK","TRK"],genre:["TCON","TCO"],picture:["APIC","PIC"],lyrics:["USLT","ULT"]};e.exports=v},{"./ID3v2FrameReader":8,"./MediaFileReader":11,"./MediaTagReader":12}],10:[function(o,f,y){function q(A){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){z=function z(B){return typeof B}}else{z=function z(B){return B&&typeof Symbol==="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B}}return z(A)}function h(z,A){if(!(z instanceof A)){throw new TypeError("Cannot call a class as a function")}}function m(C,A){for(var z=0;z<A.length;z++){var B=A[z];B.enumerable=B.enumerable||false;B.configurable=true;if("value" in B){B.writable=true}Object.defineProperty(C,B.key,B)}}function w(B,z,A){if(z){m(B.prototype,z)}if(A){m(B,A)}return B}function p(z,A){if(A&&(q(A)==="object"||typeof A==="function")){return A}return v(z)}function v(z){if(z===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return z}function s(A){z=Object.setPrototypeOf?Object.getPrototypeOf:function z(B){return B.__proto__||Object.getPrototypeOf(B)};return z(A)}function t(A,z){if(typeof z!=="function"&&z!==null){throw new TypeError("Super expression must either be null or a function")}A.prototype=Object.create(z&&z.prototype,{constructor:{value:A,writable:true,configurable:true}});if(z){g(A,z)}}function g(A,z){B=Object.setPrototypeOf||function B(D,C){D.__proto__=C;return D};return B(A,z)}var l=o("./MediaTagReader");var j=o("./MediaFileReader");var x=function(D){t(z,D);function z(){h(this,z);return p(this,s(z).apply(this,arguments))}w(z,[{key:"_loadData",value:function H(N,M){var L=this;N.loadRange([0,16],{onSuccess:function O(){L._loadAtom(N,0,"",M)},onError:M.onError})}},{key:"_loadAtom",value:function J(S,N,L,P){if(N>=S.getSize()){P.onSuccess();return}var T=this;var O=S.getLongAt(N,true);if(O==0||isNaN(O)){P.onSuccess();return}var Q=S.getStringAt(N+4,4);if(this._isContainerAtom(Q)){if(Q=="meta"){N+=4}var M=(L?L+".":"")+Q;if(M==="moov.udta.meta.ilst"){S.loadRange([N,N+O],P)}else{S.loadRange([N+8,N+8+8],{onSuccess:function R(){T._loadAtom(S,N+8,M,P)},onError:P.onError})}}else{S.loadRange([N+O,N+O+8],{onSuccess:function R(){T._loadAtom(S,N+O,L,P)},onError:P.onError})}}},{key:"_isContainerAtom",value:function E(L){return["moov","udta","meta","ilst"].indexOf(L)>=0}},{key:"_canReadAtom",value:function I(L){return L!=="----"}},{key:"_parseData",value:function B(P,M){var O={};M=this._expandShortcutTags(M);this._readAtom(O,P,0,P.getSize(),M);for(var N in n){if(n.hasOwnProperty(N)){var L=O[n[N]];if(L){if(N==="track"){O[N]=L.data.track}else{O[N]=L.data}}}}return{type:"MP4",ftyp:P.getStringAt(8,4),version:P.getLongAt(12,true),tags:O}}},{key:"_readAtom",value:function C(V,S,R,M,O,L,P){P=P===undefined?"":P+"  ";var N=R;while(N<R+M){var T=S.getLongAt(N,true);if(T==0){return}var U=S.getStringAt(N+4,4);if(this._isContainerAtom(U)){if(U=="meta"){N+=4}var Q=(L?L+".":"")+U;this._readAtom(V,S,N+8,T-8,O,Q,P);return}if((!O||O.indexOf(U)>=0)&&L==="moov.udta.meta.ilst"&&this._canReadAtom(U)){V[U]=this._readMetadataAtom(S,N)}N+=T}}},{key:"_readMetadataAtom",value:function F(Q,P){var O=16;var R=Q.getLongAt(P,true);var S=Q.getStringAt(P+4,4);var T=Q.getInteger24At(P+O+1,true);var U=e[T];var W;if(S=="trkn"){W={track:Q.getByteAt(P+O+11),total:Q.getByteAt(P+O+13)}}else{if(S=="disk"){W={disk:Q.getByteAt(P+O+11),total:Q.getByteAt(P+O+13)}}else{var V=O+4+4;var N=P+V;var M=R-V;var W;if(S==="covr"&&U==="uint8"){U="jpeg"}switch(U){case"text":W=Q.getStringWithCharsetAt(N,M,"utf-8").toString();break;case"uint8":W=Q.getShortAt(N,false);break;case"int":case"uint":var L=U=="int"?M==1?Q.getSByteAt:M==2?Q.getSShortAt:M==4?Q.getSLongAt:Q.getLongAt:M==1?Q.getByteAt:M==2?Q.getShortAt:Q.getLongAt;W=L.call(Q,N+(M==8?4:0),true);break;case"jpeg":case"png":W={format:"image/"+U,data:Q.getBytesAt(N,M)};break}}}return{id:S,size:R,description:u[S]||"Unknown",data:W}}},{key:"getShortcuts",value:function A(){return n}}],[{key:"getTagIdentifierByteRange",value:function G(){return{offset:0,length:16}}},{key:"canReadTagFormat",value:function K(L){var M=String.fromCharCode.apply(String,L.slice(4,8));return M==="ftyp"}}]);return z}(l);var e={"0":"uint8","1":"text","13":"jpeg","14":"png","21":"int","22":"uint"};var u={"©alb":"Album","©ART":"Artist",aART:"Album Artist","©day":"Release Date","©nam":"Title","©gen":"Genre",gnre:"Genre",trkn:"Track Number","©wrt":"Composer","©too":"Encoding Tool","©enc":"Encoded By",cprt:"Copyright",covr:"Cover Art","©grp":"Grouping",keyw:"Keywords","©lyr":"Lyrics","©cmt":"Comment",tmpo:"Tempo",cpil:"Compilation",disk:"Disc Number",tvsh:"TV Show Name",tven:"TV Episode ID",tvsn:"TV Season",tves:"TV Episode",tvnn:"TV Network",desc:"Description",ldes:"Long Description",sonm:"Sort Name",soar:"Sort Artist",soaa:"Sort Album",soco:"Sort Composer",sosn:"Sort Show",purd:"Purchase Date",pcst:"Podcast",purl:"Podcast URL",catg:"Category",hdvd:"HD Video",stik:"Media Type",rtng:"Content Rating",pgap:"Gapless Playback",apID:"Purchase Account",sfID:"Country Code",atID:"Artist ID",cnID:"Catalog ID",plID:"Collection ID",geID:"Genre ID","xid ":"Vendor Information",flvr:"Codec Flavor"};var k={"----":1};var n={title:"©nam",artist:"©ART",album:"©alb",year:"©day",comment:"©cmt",track:"trkn",genre:"©gen",picture:"covr",lyrics:"©lyr"};f.exports=x},{"./MediaFileReader":11,"./MediaTagReader":12}],11:[function(g,e,k){function m(o,p){if(!(o instanceof p)){throw new TypeError("Cannot call a class as a function")}}function n(s,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(s,q.key,q)}}function h(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}function f(q,o,p){if(o in q){Object.defineProperty(q,o,{value:p,enumerable:true,configurable:true,writable:true})}else{q[o]=p}return q}var j=g("./StringUtils");var l=function(){function s(I){m(this,s);f(this,"_isInitialized",void 0);f(this,"_size",void 0);this._isInitialized=false;this._size=0}h(s,[{key:"init",value:function D(J){var I=this;if(this._isInitialized){setTimeout(J.onSuccess,1)}else{return this._init({onSuccess:function K(){I._isInitialized=true;J.onSuccess()},onError:J.onError})}}},{key:"_init",value:function x(I){throw new Error("Must implement init function")}},{key:"loadRange",value:function p(I,J){throw new Error("Must implement loadRange function")}},{key:"getSize",value:function o(){if(!this._isInitialized){throw new Error("init() must be called first.")}return this._size}},{key:"getByteAt",value:function w(I){throw new Error("Must implement getByteAt function")}},{key:"getBytesAt",value:function q(L,K){var I=new Array(K);for(var J=0;J<K;J++){I[J]=this.getByteAt(L+J)}return I}},{key:"isBitSetAt",value:function E(K,J){var I=this.getByteAt(K);return(I&1<<J)!=0}},{key:"getSByteAt",value:function B(J){var I=this.getByteAt(J);if(I>127){return I-256}else{return I}}},{key:"getShortAt",value:function F(J,K){var I=K?(this.getByteAt(J)<<8)+this.getByteAt(J+1):(this.getByteAt(J+1)<<8)+this.getByteAt(J);if(I<0){I+=65536}return I}},{key:"getSShortAt",value:function z(J,K){var I=this.getShortAt(J,K);if(I>32767){return I-65536}else{return I}}},{key:"getLongAt",value:function A(N,O){var L=this.getByteAt(N),K=this.getByteAt(N+1),J=this.getByteAt(N+2),I=this.getByteAt(N+3);var M=O?(((L<<8)+K<<8)+J<<8)+I:(((I<<8)+J<<8)+K<<8)+L;if(M<0){M+=4294967296}return M}},{key:"getSLongAt",value:function y(J,K){var I=this.getLongAt(J,K);if(I>2147483647){return I-4294967296}else{return I}}},{key:"getInteger24At",value:function H(M,N){var K=this.getByteAt(M),J=this.getByteAt(M+1),I=this.getByteAt(M+2);var L=N?((K<<8)+J<<8)+I:((I<<8)+J<<8)+K;if(L<0){L+=16777216}return L}},{key:"getStringAt",value:function C(M,L){var J=[];for(var K=M,I=0;K<M+L;K++,I++){J[I]=String.fromCharCode(this.getByteAt(K))}return J.join("")}},{key:"getStringWithCharsetAt",value:function G(L,K,M){var I=this.getBytesAt(L,K);var J;switch((M||"").toLowerCase()){case"utf-16":case"utf-16le":case"utf-16be":J=j.readUTF16String(I,M==="utf-16be");break;case"utf-8":J=j.readUTF8String(I);break;default:J=j.readNullTerminatedString(I);break}return J}},{key:"getCharAt",value:function v(I){return String.fromCharCode(this.getByteAt(I))}},{key:"getSynchsafeInteger32At",value:function u(N){var M=this.getByteAt(N);var L=this.getByteAt(N+1);var K=this.getByteAt(N+2);var I=this.getByteAt(N+3);var J=I&127|(K&127)<<7|(L&127)<<14|(M&127)<<21;return J}}],[{key:"canReadFile",value:function t(I){throw new Error("Must implement canReadFile function")}}]);return s}();e.exports=l},{"./StringUtils":13}],12:[function(g,e,j){function k(o,p){if(!(o instanceof p)){throw new TypeError("Cannot call a class as a function")}}function n(s,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(s,q.key,q)}}function h(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}function f(q,o,p){if(o in q){Object.defineProperty(q,o,{value:p,enumerable:true,configurable:true,writable:true})}else{q[o]=p}return q}var l=g("./MediaFileReader");var m=function(){function v(y){k(this,v);f(this,"_mediaFileReader",void 0);f(this,"_tags",void 0);this._mediaFileReader=y;this._tags=null}h(v,[{key:"setTagsToRead",value:function x(y){this._tags=y;return this}},{key:"read",value:function p(z){var y=this;this._mediaFileReader.init({onSuccess:function A(){y._loadData(y._mediaFileReader,{onSuccess:function B(){try{var C=y._parseData(y._mediaFileReader,y._tags)}catch(D){if(z.onError){z.onError({type:"parseData",info:D.message});return}}z.onSuccess(C)},onError:z.onError})},onError:z.onError})}},{key:"getShortcuts",value:function o(){return{}}},{key:"_loadData",value:function u(z,y){throw new Error("Must implement _loadData function")}},{key:"_parseData",value:function q(z,y){throw new Error("Must implement _parseData function")}},{key:"_expandShortcutTags",value:function s(C){if(!C){return null}var z=[];var y=this.getShortcuts();for(var B=0,A;A=C[B];B++){z=z.concat(y[A]||[A])}return z}}],[{key:"getTagIdentifierByteRange",value:function t(){throw new Error("Must implement")}},{key:"canReadTagFormat",value:function w(y){throw new Error("Must implement")}}]);return v}();e.exports=m},{"./MediaFileReader":11}],13:[function(h,f,l){function m(s,t){if(!(s instanceof t)){throw new TypeError("Cannot call a class as a function")}}function q(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}function j(u,s,t){if(s){q(u.prototype,s)}if(t){q(u,t)}return u}function g(u,s,t){if(s in u){Object.defineProperty(u,s,{value:t,enumerable:true,configurable:true,writable:true})}else{u[s]=t}return u}var o=function(){function t(u,v){m(this,t);g(this,"_value",void 0);g(this,"bytesReadCount",void 0);g(this,"length",void 0);this._value=u;this.bytesReadCount=v;this.length=u.length}j(t,[{key:"toString",value:function s(){return this._value}}]);return t}();var k={readUTF16String:function p(F,u,B){var v=0;var t=1,s=0;B=Math.min(B||F.length,F.length);if(F[0]==254&&F[1]==255){u=true;v=2}else{if(F[0]==255&&F[1]==254){u=false;v=2}}if(u){t=0;s=1}var x=[];for(var w=0;v<B;w++){var E=F[v+t];var D=F[v+s];var z=(E<<8)+D;v+=2;if(z==0){break}else{if(E<216||E>=224){x[w]=String.fromCharCode(z)}else{var C=F[v+t];var A=F[v+s];var y=(C<<8)+A;v+=2;x[w]=String.fromCharCode(z,y)}}}return new o(x.join(""),v)},readUTF8String:function n(B,w){var s=0;w=Math.min(w||B.length,B.length);if(B[0]==239&&B[1]==187&&B[2]==191){s=3}var u=[];for(var t=0;s<w;t++){var z=B[s++];if(z==0){break}else{if(z<128){u[t]=String.fromCharCode(z)}else{if(z>=194&&z<224){var y=B[s++];u[t]=String.fromCharCode(((z&31)<<6)+(y&63))}else{if(z>=224&&z<240){var y=B[s++];var x=B[s++];u[t]=String.fromCharCode(((z&255)<<12)+((y&63)<<6)+(x&63))}else{if(z>=240&&z<245){var y=B[s++];var x=B[s++];var v=B[s++];var A=((z&7)<<18)+((y&63)<<12)+((x&63)<<6)+(v&63)-65536;u[t]=String.fromCharCode((A>>10)+55296,(A&1023)+56320)}}}}}}return new o(u.join(""),s)},readNullTerminatedString:function e(u,v){var s=[];v=v||u.length;for(var w=0;w<v;){var t=u[w++];if(t==0){break}s[w-1]=String.fromCharCode(t)}return new o(s.join(""),w)}};f.exports=k},{}],14:[function(k,g,n){function h(y){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){x=function x(z){return typeof z}}else{x=function x(z){return z&&typeof Symbol==="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z}}return x(y)}function s(x,y){if(!(x instanceof y)){throw new TypeError("Cannot call a class as a function")}}function w(A,y){for(var x=0;x<y.length;x++){var z=y[x];z.enumerable=z.enumerable||false;z.configurable=true;if("value" in z){z.writable=true}Object.defineProperty(A,z.key,z)}}function l(z,x,y){if(x){w(z.prototype,x)}if(y){w(z,y)}return z}function t(x,y){if(y&&(h(y)==="object"||typeof y==="function")){return y}return f(x)}function u(y){x=Object.setPrototypeOf?Object.getPrototypeOf:function x(z){return z.__proto__||Object.getPrototypeOf(z)};return x(y)}function f(x){if(x===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return x}function v(y,x){if(typeof x!=="function"&&x!==null){throw new TypeError("Super expression must either be null or a function")}y.prototype=Object.create(x&&x.prototype,{constructor:{value:y,writable:true,configurable:true}});if(x){q(y,x)}}function q(y,x){z=Object.setPrototypeOf||function z(B,A){B.__proto__=A;return B};return z(y,x)}function e(z,x,y){if(x in z){Object.defineProperty(z,x,{value:y,enumerable:true,configurable:true,writable:true})}else{z[x]=y}return z}var j=k("./ChunkedFileData");var p=k("./MediaFileReader");var m=1024;var o=function(y){v(C,y);function C(R){var S;s(this,C);S=t(this,u(C).call(this));e(f(S),"_url",void 0);e(f(S),"_fileData",void 0);S._url=R;S._fileData=new j();return S}l(C,[{key:"_init",value:function E(R){if(C._config.avoidHeadRequests){this._fetchSizeWithGetRequest(R)}else{this._fetchSizeWithHeadRequest(R)}}},{key:"_fetchSizeWithHeadRequest",value:function D(S){var R=this;this._makeXHRRequest("HEAD",null,{onSuccess:function T(V){var U=R._parseContentLength(V);if(U){R._size=U;S.onSuccess()}else{R._fetchSizeWithGetRequest(S)}},onError:S.onError})}},{key:"_fetchSizeWithGetRequest",value:function J(T){var S=this;var R=this._roundRangeToChunkMultiple([0,0]);this._makeXHRRequest("GET",R,{onSuccess:function U(X){var W=S._parseContentRange(X);var V=S._getXhrResponseContent(X);if(W){if(W.instanceLength==null){S._fetchEntireFile(T);return}S._size=W.instanceLength}else{S._size=V.length}S._fileData.addData(0,V);T.onSuccess()},onError:T.onError})}},{key:"_fetchEntireFile",value:function F(S){var R=this;this._makeXHRRequest("GET",null,{onSuccess:function T(V){var U=R._getXhrResponseContent(V);R._size=U.length;R._fileData.addData(0,U);S.onSuccess()},onError:S.onError})}},{key:"_getXhrResponseContent",value:function A(R){return R.responseBody||R.responseText||""}},{key:"_parseContentLength",value:function P(S){var R=this._getResponseHeader(S,"Content-Length");if(R==null){return R}else{return parseInt(R,10)}}},{key:"_parseContentRange",value:function O(T){var S=this._getResponseHeader(T,"Content-Range");if(S){var R=S.match(/bytes (\d+)-(\d+)\/(?:(\d+)|\*)/i);if(!R){throw new Error("FIXME: Unknown Content-Range syntax: "+S)}return{firstBytePosition:parseInt(R[1],10),lastBytePosition:parseInt(R[2],10),instanceLength:R[3]?parseInt(R[3],10):null}}else{return null}}},{key:"loadRange",value:function x(S,T){var R=this;if(R._fileData.hasDataRange(S[0],Math.min(R._size,S[1]))){setTimeout(T.onSuccess,1);return}S=this._roundRangeToChunkMultiple(S);S[1]=Math.min(R._size,S[1]);this._makeXHRRequest("GET",S,{onSuccess:function U(W){var V=R._getXhrResponseContent(W);R._fileData.addData(S[0],V);T.onSuccess()},onError:T.onError})}},{key:"_roundRangeToChunkMultiple",value:function M(R){var S=R[1]-R[0]+1;var T=Math.ceil(S/m)*m;return[R[0],R[0]+T-1]}},{key:"_makeXHRRequest",value:function K(V,R,S){var U=this._createXHRObject();U.open(V,this._url);var T=function T(){if(U.status===200||U.status===206){S.onSuccess(U)}else{if(S.onError){S.onError({type:"xhr",info:"Unexpected HTTP status "+U.status+".",xhr:U})}}U=null};if(typeof U.onload!=="undefined"){U.onload=T;U.onerror=function(){if(S.onError){S.onError({type:"xhr",info:"Generic XHR error, check xhr object.",xhr:U})}}}else{U.onreadystatechange=function(){if(U.readyState===4){T()}}}if(C._config.timeoutInSec){U.timeout=C._config.timeoutInSec*1000;U.ontimeout=function(){if(S.onError){S.onError({type:"xhr",info:"Timeout after "+U.timeout/1000+"s. Use jsmediatags.Config.setXhrTimeout to override.",xhr:U})}}}U.overrideMimeType("text/plain; charset=x-user-defined");if(R){this._setRequestHeader(U,"Range","bytes="+R[0]+"-"+R[1])}this._setRequestHeader(U,"If-Modified-Since","Sat, 01 Jan 1970 00:00:00 GMT");U.send(null)}},{key:"_setRequestHeader",value:function Q(S,T,R){if(C._config.disallowedXhrHeaders.indexOf(T.toLowerCase())<0){S.setRequestHeader(T,R)}}},{key:"_hasResponseHeader",value:function N(V,W){var T=V.getAllResponseHeaders();if(!T){return false}var U=T.split("\r\n");var S=[];for(var R=0;R<U.length;R++){S[R]=U[R].split(":")[0].toLowerCase()}return S.indexOf(W.toLowerCase())>=0}},{key:"_getResponseHeader",value:function H(R,S){if(!this._hasResponseHeader(R,S)){return null}return R.getResponseHeader(S)}},{key:"getByteAt",value:function B(S){var R=this._fileData.getByteAt(S);return R.charCodeAt(0)&255}},{key:"_isWebWorker",value:function L(){return typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope}},{key:"_createXHRObject",value:function G(){if(typeof window==="undefined"&&!this._isWebWorker()){return new (k("xhr2").XMLHttpRequest)()}if(typeof XMLHttpRequest!=="undefined"){return new XMLHttpRequest()}throw new Error("XMLHttpRequest is not supported")}}],[{key:"canReadFile",value:function z(R){return typeof R==="string"&&/^[a-z]+:\/\//i.test(R)}},{key:"setConfig",value:function I(S){for(var U in S){if(S.hasOwnProperty(U)){this._config[U]=S[U]}}var R=this._config.disallowedXhrHeaders;for(var T=0;T<R.length;T++){R[T]=R[T].toLowerCase()}}}]);return C}(p);e(o,"_config",void 0);o._config={avoidHeadRequests:false,disallowedXhrHeaders:[],timeoutInSec:30};g.exports=o},{"./ChunkedFileData":5,"./MediaFileReader":11,xhr2:2}],15:[function(n,f,D){function g(E,F){if(!(E instanceof F)){throw new TypeError("Cannot call a class as a function")}}function l(H,F){for(var E=0;E<F.length;E++){var G=F[E];G.enumerable=G.enumerable||false;G.configurable=true;if("value" in G){G.writable=true}Object.defineProperty(H,G.key,G)}}function x(G,E,F){if(E){l(G.prototype,E)}if(F){l(G,F)}return G}function y(G,E,F){if(E in G){Object.defineProperty(G,E,{value:F,enumerable:true,configurable:true,writable:true})}else{G[E]=F}return G}var h=n("./MediaFileReader");var m=n("./XhrFileReader");var j=n("./BlobFileReader");var u=n("./ArrayFileReader");var k=n("./MediaTagReader");var q=n("./ID3v1TagReader");var z=n("./ID3v2TagReader");var B=n("./MP4TagReader");var e=n("./FLACTagReader");var A=[];var t=[];function w(E,F){new C(E).read(F)}function v(F,E){var H=F.offset>=0&&F.offset+F.length>=E;var G=F.offset<0&&(-F.offset>E||F.offset+F.length>0);return !(H||G)}var C=function(){function L(O){g(this,L);y(this,"_file",void 0);y(this,"_tagsToRead",void 0);y(this,"_fileReader",void 0);y(this,"_tagReader",void 0);this._file=O}x(L,[{key:"setTagsToRead",value:function N(O){this._tagsToRead=O;return this}},{key:"setFileReader",value:function G(O){this._fileReader=O;return this}},{key:"setTagReader",value:function J(O){this._tagReader=O;return this}},{key:"read",value:function E(Q){var R=this._getFileReader();var O=new R(this._file);var P=this;O.init({onSuccess:function S(){P._getTagReader(O,{onSuccess:function T(U){new U(O).setTagsToRead(P._tagsToRead).read(Q)},onError:Q.onError})},onError:Q.onError})}},{key:"_getFileReader",value:function I(){if(this._fileReader){return this._fileReader}else{return this._findFileReader()}}},{key:"_findFileReader",value:function K(){for(var O=0;O<A.length;O++){if(A[O].canReadFile(this._file)){return A[O]}}throw new Error("No suitable file reader found for "+this._file)}},{key:"_getTagReader",value:function M(O,P){if(this._tagReader){var Q=this._tagReader;setTimeout(function(){P.onSuccess(Q)},1)}else{this._findTagReader(O,P)}}},{key:"_findTagReader",value:function H(Q,U){var O=[];var R=[];var P=Q.getSize();for(var S=0;S<t.length;S++){var T=t[S].getTagIdentifierByteRange();if(!v(T,P)){continue}if(T.offset>=0&&T.offset<P/2||T.offset<0&&T.offset<-P/2){O.push(t[S])}else{R.push(t[S])}}var X=false;var W={onSuccess:function V(){if(!X){X=true;return}for(var aa=0;aa<t.length;aa++){var Y=t[aa].getTagIdentifierByteRange();if(!v(Y,P)){continue}try{var ab=Q.getBytesAt(Y.offset>=0?Y.offset:Y.offset+P,Y.length)}catch(Z){if(U.onError){U.onError({type:"fileReader",info:Z.message})}return}if(t[aa].canReadTagFormat(ab)){U.onSuccess(t[aa]);return}}if(U.onError){U.onError({type:"tagFormat",info:"No suitable tag reader found"})}},onError:U.onError};this._loadTagIdentifierRanges(Q,O,W);this._loadTagIdentifierRanges(Q,R,W)}},{key:"_loadTagIdentifierRanges",value:function F(S,R,V){if(R.length===0){setTimeout(V.onSuccess,1);return}var W=[Number.MAX_VALUE,0];var P=S.getSize();for(var T=0;T<R.length;T++){var U=R[T].getTagIdentifierByteRange();var O=U.offset>=0?U.offset:U.offset+P;var Q=O+U.length-1;W[0]=Math.min(O,W[0]);W[1]=Math.max(Q,W[1])}S.loadRange(W,V)}}]);return L}();var o=function(){function G(){g(this,G)}x(G,null,[{key:"addFileReader",value:function K(L){A.push(L);return G}},{key:"addTagReader",value:function J(L){t.push(L);return G}},{key:"removeTagReader",value:function I(M){var L=t.indexOf(M);if(L>=0){t.splice(L,1)}return G}},{key:"EXPERIMENTAL_avoidHeadRequests",value:function F(){m.setConfig({avoidHeadRequests:true})}},{key:"setDisallowedXhrHeaders",value:function H(L){m.setConfig({disallowedXhrHeaders:L})}},{key:"setXhrTimeoutInSec",value:function E(L){m.setConfig({timeoutInSec:L})}}]);return G}();o.addFileReader(m).addFileReader(j).addFileReader(u).addTagReader(z).addTagReader(q).addTagReader(B).addTagReader(e);if(typeof process!=="undefined"&&!process.browser){if(typeof navigator!=="undefined"&&navigator.product==="ReactNative"){var p=n("./ReactNativeFileReader");o.addFileReader(p)}else{var s=n("./NodeFileReader");o.addFileReader(s)}}f.exports={read:w,Reader:C,Config:o}},{"./ArrayFileReader":3,"./BlobFileReader":4,"./FLACTagReader":6,"./ID3v1TagReader":7,"./ID3v2TagReader":9,"./MP4TagReader":10,"./MediaFileReader":11,"./MediaTagReader":12,"./NodeFileReader":1,"./ReactNativeFileReader":1,"./XhrFileReader":14}]},{},[15])(15)});var visualizer;var jsmediatags=window.jsmediatags;$(document).ready(function(){visualizer=new AudioVisualizer();visualizer.initialize();visualizer.setupAudioProcessing();visualizer.getAudio();visualizer.handleDrop();particlesJS.load("particles","json/particles.json",function(){console.log("callback - particles.js config loaded")})});function Particle(a){this.id=a;this.hue=rand(50,0,1);this.active=false}function AudioVisualizer(){this.height;this.width;this.time=0;this.cxt;this.ratio;this.wrap;this.particleNum=100;this.particles=[];this.barNum=180;this.curvePoints=[];this.circlePoints=[];this.javascriptNode;this.audioContext;this.sourceBuffer;this.analyser;this.played=false;this.isauthorized=false;this.totalTime;this.startTime}function getRatio(a){return window.devicePixelRatio||1/(a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1)}AudioVisualizer.prototype.initialize=function(){this.wrap=document.getElementById("wrap");this.cxt=this.wrap.getContext("2d");var b=window.innerWidth,c=window.innerHeight;this.ratio=getRatio(this.ctx);this.height=c*this.ratio;this.width=b*this.ratio;this.wrap.style.height=c+"px";this.wrap.style.width=b+"px";this.wrap.width=b*this.ratio;this.wrap.height=c*this.ratio;let that=this;window.addEventListener("resize",function(){var d=window.innerWidth,e=window.innerHeight;that.height=e*that.ratio;that.width=d*that.ratio;that.wrap.style.height=e+"px";that.wrap.style.width=d+"px";that.wrap.width=d*that.ratio;that.wrap.height=e*that.ratio});for(var a=0;a<this.particleNum;a++){this.particles.push(new Particle(a))}};function rand(a,c,b){var a=(a===0||a)?a:1,c=c||0,d=c+(a-c)*Math.random();return(b)?Math.round(d):d}function getmin(b,a){return b>a?a:b}function drawCurve(b,c,d,e,a){b.beginPath();drawLines(b,getCurvePoints(c,d,e,a));b.stroke()}function getCurvePoints(u,d,k,h){d=(typeof d!="undefined")?d:0.5;k=k?k:false;h=h?h:16;var a=[],v=[],f,e,c,n,b,l,p,o,m,j,q,g,s;a=u.slice(0);if(k){a.unshift(u[u.length-1]);a.unshift(u[u.length-2]);a.unshift(u[u.length-1]);a.unshift(u[u.length-2]);a.push(u[0]);a.push(u[1])}else{a.unshift(u[1]);a.unshift(u[0]);a.push(u[u.length-2]);a.push(u[u.length-1])}for(s=2;s<(a.length-4);s+=2){for(g=0;g<=h;g++){c=(a[s+2]-a[s-2])*d;n=(a[s+4]-a[s])*d;b=(a[s+3]-a[s-1])*d;l=(a[s+5]-a[s+1])*d;q=g/h;p=2*Math.pow(q,3)-3*Math.pow(q,2)+1;o=-(2*Math.pow(q,3))+3*Math.pow(q,2);m=Math.pow(q,3)-2*Math.pow(q,2)+q;j=Math.pow(q,3)-Math.pow(q,2);f=p*a[s]+o*a[s+2]+m*c+j*n;e=p*a[s+1]+o*a[s+3]+m*b+j*l;v.push(f);v.push(e)}}return v}function drawLines(a,b){a.moveTo(b[0],b[1]);for(i=2;i<b.length-1;i+=2){a.lineTo(b[i],b[i+1])}}AudioVisualizer.prototype.setupAudioProcessing=function(){this.audioContext=new (window.AudioContext||window.webkitAudioContext)();this.javascriptNode=this.audioContext.createScriptProcessor(2048,1,1);this.javascriptNode.connect(this.audioContext.destination);this.analyser=this.audioContext.createAnalyser();this.analyser.smoothingTimeConstant=0.6;this.analyser.fftSize=512;this.analyser.connect(this.javascriptNode);let that=this;let output=new Uint8Array(180);let rotation=0,barWidth=that.wrap.width/180,rotationC=0;const a=1,c=1;(function b(){visualizer.analyser.getByteFrequencyData(output);let potInt={x:that.width/2,y:that.height/2};let r=getmin(getmin(potInt.x-50,potInt.y-50),175*that.ratio);that.cxt.clearRect(0,0,that.wrap.width,that.wrap.height);that.cxt.strokeStyle="#C0F1FA";that.cxt.lineWidth=a*that.ratio;that.cxt.fillStyle="#C0F1FA";that.curvePoints.length=0;that.circlePoints.length=0;for(let i=0;i<180;i++){let value=output[i]/6*that.ratio;that.cxt.beginPath();let Rv1=(r-value);let Rv2=(r+value);let temp=rotation*2+540;that.cxt.moveTo((Math.sin((i*c+rotation)/180*Math.PI)*Rv1+potInt.x),-Math.cos((i*c+rotation)/180*Math.PI)*Rv1+potInt.y);that.cxt.lineTo((Math.sin((i*c+rotation)/180*Math.PI)*Rv2+potInt.x),-Math.cos((i*c+rotation)/180*Math.PI)*Rv2+potInt.y);that.cxt.moveTo((Math.sin((temp-(i*c+180+rotation))/180*Math.PI)*Rv1+potInt.x),-Math.cos((temp-(i*c+180+rotation))/180*Math.PI)*Rv1+potInt.y);that.cxt.lineTo((Math.sin((temp-(i*c+180+rotation))/180*Math.PI)*Rv2+potInt.x),-Math.cos((temp-(i*c+180+rotation))/180*Math.PI)*Rv2+potInt.y);that.cxt.stroke();barWidth=that.wrap.width/180;that.cxt.fillRect(barWidth*i,that.wrap.height,barWidth-1,-1*value);if(i%3===0||i===179){that.curvePoints.push(barWidth*(i+0.5)-0.5);that.curvePoints.push(that.wrap.height-value-40)}}that.circlePoints.push(Math.sin((rotationC)/180*Math.PI)*(r+output[0]/4)+potInt.x);that.circlePoints.push(-Math.cos((rotationC)/180*Math.PI)*(r+output[0]/4)+potInt.y);for(let i=1;i<90;++i){if(i%3===0){let value=output[i]/6*that.ratio;that.circlePoints.push(Math.sin((i*4+rotationC)/180*Math.PI)*(r-10*that.ratio+value)+potInt.x);that.circlePoints.push(-Math.cos((i*4+rotationC)/180*Math.PI)*(r-10*that.ratio+value)+potInt.y)}}if(that.played){drawCurve(that.cxt,that.circlePoints,0.5,true);drawCurve(that.cxt,that.curvePoints)}rotation+=0.1;rotationC-=0.1;for(let i=0;that.played&&i<that.particles.length;i++){if(that.particles[i].active===true){that.particles[i].active=true;that.particles[i].x+=that.particles[i].vx;that.particles[i].y+=that.particles[i].vy;that.particles[i].hue-=0.5;that.particles[i].r=Math.abs(that.particles[i].r-0.05);that.cxt.beginPath();that.cxt.rect(that.particles[i].x,that.particles[i].y,that.particles[i].r,that.particles[i].r);that.cxt.fillStyle="hsla("+that.particles[i].hue+",100%,50%,1)";that.cxt.fill();if(that.particles[i].r<=0.05){that.particles[i].active=false}}else{that.particles[i].x=that.width/2;that.particles[i].y=that.height/2;that.particles[i].r=rand(12,6,1);that.particles[i].vx=Math.random()*5-2.5;that.particles[i].vy=Math.sqrt((Math.random()*6.5)-(that.particles[i].vx)*(that.particles[i].vx))*(Math.random()<0.5?-1:1);that.particles[i].opacity=Math.random()+0.5;that.particles[i].active=true;that.cxt.beginPath();that.cxt.rect(that.particles[i].x,that.particles[i].y,that.particles[i].r,that.particles[i].r);that.cxt.fillStyle="hsla("+that.particles[i].hue+",100%,50%,0.5)";that.cxt.fill()}}requestAnimationFrame(b)})()};AudioVisualizer.prototype.getAudio=function(){var b=new XMLHttpRequest();b.open("GET","https://server.soptq.me/blog/music/demo.mp3",true);b.responseType="arraybuffer";b.send();var a=this;b.onload=function(){if(!a.played){jsmediatags.read(b.response,{onSuccess:function(c){var f=c.tags.picture.data;var e="";for(var d=0;d<f.length;d++){e+=String.fromCharCode(f[d])}document.querySelector("#audio-pic").src="data:"+c.tags.picture.format+";base64,"+window.btoa(e)},onError:function(c){console.log(c);if(!document.querySelector("#audio-pic").classList.contains("hidden")){document.querySelector("#audio-pic").classList.add("hidden")}}});a.start(b.response)}}};AudioVisualizer.prototype.start=function(b){try{this.sourceBuffer.stop();this.sourceBuffer.disconnect(0)}catch(d){}this.sourceBuffer=this.audioContext.createBufferSource();this.sourceBuffer.loop=true;this.sourceBuffer.connect(this.analyser);this.sourceBuffer.connect(this.audioContext.destination);this.audioContext.decodeAudioData(b,a,c);let that=this;document.getElementById("loading-icon").classList.add("hidden");document.getElementById("play-icon").classList.remove("hidden");function a(e){that.sourceBuffer.buffer=e;that.totalTime=e.duration;if(that.isauthorized){that.sourceBuffer.start(0);that.startTime=that.audioContext.currentTime}else{document.getElementById("play-icon").onclick=function(){that.sourceBuffer.start(0);that.startTime=that.audioContext.currentTime;that.isauthorized=true;that.played=true;$("#authorize")[0].remove();if(document.querySelector("#audio-pic").classList.contains("hidden")){document.querySelector("#audio-pic").classList.remove("hidden")}}}}function c(){}};AudioVisualizer.prototype.getRandomColor=function(){var c="0123456789ABCDEF".split("");var a="#";for(var b=0;b<6;b++){a+=c[Math.floor(Math.random()*16)]}return a};AudioVisualizer.prototype.handleDrop=function(){document.body.addEventListener("dragenter",function(){},false);document.body.addEventListener("dragover",function(a){a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="copy"},false);document.body.addEventListener("dragleave",function(){},false);document.body.addEventListener("drop",function(c){c.stopPropagation();c.preventDefault();var b=c.dataTransfer.files[0];jsmediatags.read(b,{onSuccess:function(e){var h=e.tags.picture.data;var g="";for(var f=0;f<h.length;f++){g+=String.fromCharCode(h[f])}document.querySelector("#audio-pic").src="data:"+e.tags.picture.format+";base64,"+window.btoa(g)},onError:function(e){console.log(e);if(!document.querySelector("#audio-pic").classList.contains("hidden")){document.querySelector("#audio-pic").classList.add("hidden")}}});var d=b.name;var a=new FileReader();a.onload=function(g){var f=g.target.result;visualizer.start(f)};a.onerror=function(f){};a.readAsArrayBuffer(b)},false)};